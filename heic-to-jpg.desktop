[Desktop Entry]
Type=Service
ServiceTypes=KonqPopupMenu/Plugin
MimeType=image/heic;image/heif;
Actions=convertToJpg;

[Desktop Action convertToJpg]
Name=Convert HEIC to JPG
Icon=image-x-generic
Exec=sh -c 'f="%f"; out="${f%.*}.jpg"; HEIF_CONVERT=$(command -v heif-convert 2>/dev/null); [ -z "$HEIF_CONVERT" ] && { [ -x "/home/linuxbrew/.linuxbrew/bin/heif-convert" ] && HEIF_CONVERT="/home/linuxbrew/.linuxbrew/bin/heif-convert" || HEIF_CONVERT="$HOME/.linuxbrew/bin/heif-convert"; }; [ -x "$HEIF_CONVERT" ] && "$HEIF_CONVERT" "$f" "$out" || kdialog --error "Requires the heif-convert command in your system path or installed via homebrew (/home/linuxbrew/.linuxbrew/bin or $HOME/.linuxbrew/bin). Install libheif-tools to provide this command. e.g.: brew install libheif"'
